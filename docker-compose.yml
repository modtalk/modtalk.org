elasticsearch:
  image: elasticsearch:1.5
  expose:
    - 9200

web:
  image: rails
  command: "/bin/sh -c 'rm -f tmp/pids/server.pid && bundle exec rails s -b 0.0.0.0'"
  volumes:
    - .:/rails-app
    - /home/adam/rubygems_cache:/gem-store
  expose:
    - 3000
  links:
    - elasticsearch
  environment:
    RAILS_ENV: development
    VIRTUAL_HOST: modtalk.devvm
    GEM_HOME: /gem-store

browsersync:
  image: browsersync
  command: "nodejs /usr/local/bin/browser-sync start --proxy 'web:3000' --files '/app/app/**' --host 0.0.0.0 --port 80"
  links:
    - web
  expose:
    - 80
  volumes:
    - .:/app:ro
  environment:
    VIRTUAL_HOST: modtalk-sync.devvm
